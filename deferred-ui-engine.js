/**
 * Deferred UI engine.
 * Injects non-critical overlays/widgets before main app bootstrap.
 */
(function () {
    'use strict';

    const mount = document.getElementById('deferredUiMount');
    if (!mount) {
        return;
    }

    if (document.getElementById('videoModal') || document.getElementById('chatbotWidget')) {
        return;
    }

    mount.innerHTML = "    <!-- Video Options Modal -->\n    <div class=\"modal\" id=\"videoModal\">\n        <div class=\"modal-content\">\n            <button type=\"button\" class=\"modal-close\" data-action=\"close-video-modal\">\n                <i class=\"fas fa-times\"></i>\n            </button>\n            <h3 data-i18n=\"video_modal_title\">Elige c√≥mo quieres hacer la videollamada:</h3>\n            \n            <a href=\"https://meet.jit.si/PielEnArmonia-Consulta\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"video-option\">\n                <div class=\"video-option-icon video-option-icon-jitsi\">\n                    <i class=\"fas fa-video\"></i>\n                </div>\n                <div class=\"video-option-info\">\n                    <h4 data-i18n=\"video_jitsi\">Jitsi Meet (Recomendado)</h4>\n                    <p data-i18n=\"video_jitsi_desc\">Sin registro. Funciona en cualquier navegador.</p>\n                </div>\n                <i class=\"fas fa-external-link-alt\"></i>\n            </a>\n            \n            <a href=\"https://wa.me/593982453672?text=Hola%20doctor,%20solicito%20videoconsulta\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"video-option\">\n                <div class=\"video-option-icon video-option-icon-whatsapp\">\n                    <i class=\"fab fa-whatsapp\"></i>\n                </div>\n                <div class=\"video-option-info\">\n                    <h4 data-i18n=\"video_whatsapp\">WhatsApp Video</h4>\n                    <p data-i18n=\"video_whatsapp_desc\">Usa la app de WhatsApp que ya tienes.</p>\n                </div>\n                <i class=\"fas fa-external-link-alt\"></i>\n            </a>\n            \n            <div class=\"video-tip\">\n                <i class=\"fas fa-info-circle\"></i>\n                <p data-i18n=\"video_tip\">Despu√©s de abrir la videollamada, comparte el enlace o ID con el doctor por WhatsApp.</p>\n            </div>\n        </div>\n    </div>\n\n    <!-- Payment Modal -->\n    <div class=\"modal\" id=\"paymentModal\">\n        <div class=\"modal-content payment-modal\">\n            <button type=\"button\" class=\"modal-close\" data-action=\"close-payment-modal\">\n                <i class=\"fas fa-times\"></i>\n            </button>\n            <h3 data-i18n=\"payment_title\">M√©todo de Pago</h3>\n            \n            <div class=\"payment-methods\">\n                <div class=\"payment-method active\" data-method=\"card\">\n                    <i class=\"fas fa-credit-card\"></i>\n                    <span data-i18n=\"pay_card\">Tarjeta</span>\n                </div>\n                <div class=\"payment-method\" data-method=\"transfer\">\n                    <i class=\"fas fa-university\"></i>\n                    <span data-i18n=\"pay_transfer\">Transferencia</span>\n                </div>\n                <div class=\"payment-method\" data-method=\"cash\">\n                    <i class=\"fas fa-money-bill-wave\"></i>\n                    <span data-i18n=\"pay_cash\">Efectivo</span>\n                </div>\n            </div>\n            \n            <div class=\"payment-details\" id=\"paymentDetails\">\n                <!-- Card Payment -->\n                <div class=\"payment-form card-form\">\n                    <div class=\"form-group\">\n                        <label data-i18n=\"label_card_name\">Nombre en la tarjeta</label>\n                        <input type=\"text\" id=\"cardholderName\" autocomplete=\"cc-name\" placeholder=\"Nombre del titular\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label data-i18n=\"label_card_number\">Datos de tarjeta</label>\n                        <div id=\"stripeCardElement\" class=\"stripe-card-element\"></div>\n                        <small class=\"payment-help\">Tus datos se procesan de forma segura con Stripe.</small>\n                    </div>\n                </div>\n\n                <!-- Transfer Payment -->\n                <div class=\"payment-form transfer-form is-hidden\">\n                    <div class=\"bank-info\">\n                        <p><strong data-i18n=\"bank_name\">Banco Pichincha</strong></p>\n                        <p data-i18n=\"bank_account\">Cuenta de Ahorros: 2200160272</p>\n                        <p data-i18n=\"bank_owner\">Titular: Rosero Caiza Javier Alejandro</p>\n                    </div>\n                    <div class=\"form-group\">\n                        <label data-i18n=\"label_transfer_ref\">N√∫mero de referencia</label>\n                        <input type=\"text\" id=\"transferReference\" placeholder=\"Ej: 123456\">\n                    </div>\n                    <div class=\"form-group\">\n                        <label>Comprobante (JPG, PNG, WEBP o PDF)</label>\n                        <input type=\"file\" id=\"transferProofFile\" accept=\".jpg,.jpeg,.png,.webp,.pdf\">\n                        <small id=\"transferProofFileName\" class=\"payment-help\"></small>\n                    </div>\n                </div>\n                \n                <!-- Cash Payment -->\n                <div class=\"payment-form cash-form is-hidden\">\n                    <p data-i18n=\"cash_info\">Paga directamente en el consultorio el d√≠a de tu cita.</p>\n                </div>\n            </div>\n            \n            <div class=\"payment-summary\">\n                <div class=\"payment-total\">\n                    <span data-i18n=\"payment_total\">Total a pagar:</span>\n                    <span id=\"paymentTotal\">$0.00</span>\n                </div>\n            </div>\n            <div class=\"payment-trust-badges\" aria-label=\"Seguridad de pago\">\n                <span class=\"trust-badge-item\"><i class=\"fas fa-lock\"></i> <span data-i18n=\"payment_trust_ssl\">Conexi√≥n segura SSL/TLS</span></span>\n                <span class=\"trust-badge-item\"><i class=\"fab fa-stripe\"></i> <span data-i18n=\"payment_trust_stripe\">Cobro protegido con Stripe</span></span>\n                <span class=\"trust-badge-item\"><i class=\"fas fa-file-invoice-dollar\"></i> <span data-i18n=\"payment_trust_invoice\">Facturaci√≥n y soporte por WhatsApp</span></span>\n            </div>\n            <div class=\"payment-faq\">\n                <h4 data-i18n=\"payment_faq_title\">Preguntas frecuentes de pago</h4>\n                <details>\n                    <summary data-i18n=\"payment_faq_refund_q\">Reembolsos y cancelaciones</summary>\n                    <p data-i18n=\"payment_faq_refund_a\">Si cancelas con anticipaci√≥n, coordinamos reembolso o saldo a favor seg√∫n el caso cl√≠nico y t√©rminos vigentes.</p>\n                </details>\n                <details>\n                    <summary data-i18n=\"payment_faq_reschedule_q\">Reprogramaci√≥n de citas</summary>\n                    <p data-i18n=\"payment_faq_reschedule_a\">Puedes reprogramar sin costo en horarios disponibles. Si ya pagaste, tu pago se mantiene para la nueva fecha.</p>\n                </details>\n                <details>\n                    <summary data-i18n=\"payment_faq_billing_q\">Facturaci√≥n</summary>\n                    <p data-i18n=\"payment_faq_billing_a\">Emitimos comprobante/factura con los datos enviados en la reserva. Si necesitas ajuste, escr√≠benos por WhatsApp.</p>\n                </details>\n                <details>\n                    <summary data-i18n=\"payment_faq_include_q\">Qu√© incluye cada servicio</summary>\n                    <p data-i18n=\"payment_faq_include_a\">Cada servicio indica valor base y tipo de atenci√≥n. Si requiere procedimientos adicionales, se informa antes de confirmar.</p>\n                </details>\n            </div>\n            <div id=\"paymentError\" class=\"payment-error is-hidden\"></div>\n            \n            <button type=\"button\" class=\"btn btn-primary btn-full\" data-action=\"process-payment\">\n                <i class=\"fas fa-lock\"></i>\n                <span data-i18n=\"btn_pay\">Confirmar Reserva</span>\n            </button>\n        </div>\n    </div>\n\n    <!-- Success Modal -->\n    <div class=\"modal\" id=\"successModal\">\n        <div class=\"modal-content success-content\">\n            <div class=\"success-icon\">\n                <i class=\"fas fa-check-circle\"></i>\n            </div>\n            <h3 data-i18n=\"success_title\">¬°Cita Confirmada!</h3>\n            <p data-i18n=\"success_desc\">Tu cita fue registrada correctamente.</p>\n            <div id=\"appointmentDetails\"></div>\n            <button type=\"button\" class=\"btn btn-primary\" data-action=\"close-success-modal\">\n                <span data-i18n=\"btn_done\">Entendido</span>\n            </button>\n        </div>\n    </div>\n\n    <!-- Reschedule Modal -->\n    <div class=\"modal\" id=\"rescheduleModal\">\n        <div class=\"modal-content\">\n            <button type=\"button\" class=\"modal-close\" data-action=\"close-reschedule-modal\">&times;</button>\n            <h3 data-i18n=\"reschedule_title\">Reprogramar Cita</h3>\n            <div id=\"rescheduleInfo\"></div>\n            <div class=\"form-group\">\n                <label data-i18n=\"reschedule_new_date\">Nueva fecha</label>\n                <input type=\"date\" id=\"rescheduleDate\" class=\"form-control\" />\n            </div>\n            <div class=\"form-group\">\n                <label data-i18n=\"reschedule_new_time\">Nuevo horario</label>\n                <select id=\"rescheduleTime\" class=\"form-control\">\n                    <option value=\"\" data-i18n=\"reschedule_select_time\">Selecciona un horario</option>\n                </select>\n            </div>\n            <div id=\"rescheduleError\" class=\"form-error is-hidden\"></div>\n            <button type=\"button\" class=\"btn btn-primary\" id=\"rescheduleSubmitBtn\" data-action=\"submit-reschedule\">\n                <span data-i18n=\"reschedule_confirm\">Confirmar reprogramaci√≥n</span>\n            </button>\n        </div>\n    </div>\n\n    <!-- Chatbot Widget -->\n    <div class=\"chatbot-widget\" id=\"chatbotWidget\">\n        <button type=\"button\" class=\"chatbot-toggle\" data-action=\"toggle-chatbot\" aria-label=\"Abrir chat\">\n            <i class=\"fas fa-comments\"></i>\n            <span class=\"chatbot-notification\" id=\"chatNotification\">1</span>\n        </button>\n        \n        <div class=\"chatbot-container\" id=\"chatbotContainer\">\n            <div class=\"chatbot-header\">\n                <div class=\"chatbot-avatar\">\n                    <i class=\"fas fa-user-md\"></i>\n                </div>\n                <div class=\"chatbot-info\">\n                    <h4>Dr. Virtual</h4>\n                    <span class=\"chatbot-status\">\n                        <i class=\"fas fa-circle\"></i>\n                        En l√≠nea\n                    </span>\n                </div>\n                <div class=\"chatbot-actions\">\n                    <button type=\"button\" data-action=\"minimize-chat\" aria-label=\"Minimizar\">\n                        <i class=\"fas fa-minus\"></i>\n                    </button>\n                    <button type=\"button\" data-action=\"toggle-chatbot\" aria-label=\"Cerrar\">\n                        <i class=\"fas fa-times\"></i>\n                    </button>\n                </div>\n            </div>\n            \n            <div class=\"chatbot-messages\" id=\"chatMessages\">\n                <div class=\"chat-message bot\">\n                    <div class=\"message-avatar\">\n                        <i class=\"fas fa-user-md\"></i>\n                    </div>\n                    <div class=\"message-content\">\n                        <p>¬°Hola! Soy el asistente virtual de <strong>Piel en Armon√≠a</strong>. ü©∫</p>\n                        <p>¬øEn qu√© puedo ayudarte hoy?</p>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"chatbot-quick-options\" id=\"quickOptions\">\n                <button type=\"button\" data-action=\"quick-message\" data-value=\"services\">Ver servicios</button>\n                <button type=\"button\" data-action=\"quick-message\" data-value=\"appointment\">Agendar cita</button>\n                <button type=\"button\" data-action=\"quick-message\" data-value=\"prices\">Consultar precios</button>\n                <button type=\"button\" data-action=\"quick-message\" data-value=\"human\">Hablar con humano</button>\n            </div>\n\n            <p class=\"chatbot-disclaimer\" data-i18n=\"chat_disclaimer\">\n                Este asistente ofrece orientacion general y no reemplaza una consulta medica profesional.\n            </p>\n            \n            <div class=\"chatbot-input-area\">\n                <input type=\"text\" id=\"chatInput\" placeholder=\"Escribe tu mensaje...\">\n                <button type=\"button\" data-action=\"send-chat-message\" aria-label=\"Enviar\">\n                    <i class=\"fas fa-paper-plane\"></i>\n                </button>\n            </div>\n        </div>\n    </div>\n\n    <div class=\"quick-dock\" aria-label=\"Acciones rapidas\">\n        <a href=\"#citas\" class=\"quick-dock-item\">\n            <i class=\"fas fa-calendar-check\"></i>\n            <span>Reservar</span>\n        </a>\n        <a href=\"https://wa.me/593982453672\" target=\"_blank\" rel=\"noopener noreferrer\" class=\"quick-dock-item\">\n            <i class=\"fab fa-whatsapp\"></i>\n            <span>WhatsApp</span>\n        </a>\n        <a href=\"tel:+593982453672\" class=\"quick-dock-item\">\n            <i class=\"fas fa-phone-alt\"></i>\n            <span>Llamar</span>\n        </a>\n    </div>\n\n    <!-- Review Modal -->\n    <div class=\"modal\" id=\"reviewModal\">\n        <div class=\"modal-content\">\n            <button type=\"button\" class=\"modal-close\" data-action=\"close-review-modal\">\n                <i class=\"fas fa-times\"></i>\n            </button>\n            <h3 data-i18n=\"review_modal_title\">Escribe tu Rese√±a</h3>\n            <form id=\"reviewForm\">\n                <div class=\"form-group\">\n                    <label data-i18n=\"label_your_name\">Tu nombre</label>\n                    <input type=\"text\" name=\"reviewerName\" required>\n                </div>\n                <div class=\"form-group\">\n                    <label data-i18n=\"label_rating\">Calificaci√≥n</label>\n                    <div class=\"star-rating\">\n                        <i class=\"far fa-star\" data-rating=\"1\"></i>\n                        <i class=\"far fa-star\" data-rating=\"2\"></i>\n                        <i class=\"far fa-star\" data-rating=\"3\"></i>\n                        <i class=\"far fa-star\" data-rating=\"4\"></i>\n                        <i class=\"far fa-star\" data-rating=\"5\"></i>\n                    </div>\n                </div>\n                <div class=\"form-group\">\n                    <label data-i18n=\"label_review\">Tu experiencia</label>\n                    <textarea name=\"reviewText\" rows=\"4\" required></textarea>\n                </div>\n                <button type=\"submit\" class=\"btn btn-primary btn-full\">\n                    <span data-i18n=\"btn_submit_review\">Publicar Rese√±a</span>\n                </button>\n            </form>\n        </div>\n    </div>\n\n\n    <div class=\"cookie-banner\" id=\"cookieBanner\" role=\"dialog\" aria-live=\"polite\" aria-label=\"Preferencias de cookies\">\n        <p class=\"cookie-text\" data-i18n=\"cookie_banner_text\">\n            Usamos cookies esenciales para seguridad y funcionamiento. Puedes aceptar o rechazar cookies opcionales.\n        </p>\n        <div class=\"cookie-actions\">\n            <button type=\"button\" class=\"btn btn-secondary cookie-btn\" id=\"cookieRejectBtn\" data-i18n=\"cookie_reject\">Rechazar</button>\n            <button type=\"button\" class=\"btn btn-primary cookie-btn\" id=\"cookieAcceptBtn\" data-i18n=\"cookie_accept\">Aceptar</button>\n            <a href=\"cookies.html\" class=\"cookie-link\" data-i18n=\"cookie_more\">M√°s informaci√≥n</a>\n        </div>\n    </div>";
})();
